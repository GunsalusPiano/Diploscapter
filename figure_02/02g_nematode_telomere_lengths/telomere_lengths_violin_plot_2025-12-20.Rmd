---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(ggplot2)
library(tidyverse)

axis_text_size <- 8


selected_telomeres_df = read_tsv("all_nematode_telomeres.headerless.txt", col_names=c("accession", "species", "strain", "description", "read_name", "telomere_length"),
                            col_types=c("c", "c", "c", "c", "c", "i"), comment = "#")


telomere_dotplot_horizontal <- ggplot(selected_telomeres_df, aes(description, telomere_length)) +
                                geom_dotplot(binaxis = "y",
                                   stackdir = "center",
                                   fill = "black",
                                   dotsize = 1,
                                   binwidth = 50,
                                   stackratio = 0.7,
                                   alpha = 0.7,
                                   stroke = 0) +
                                theme_bw() +   
                                xlab("experiment") +
                                ylab("double-stranded telomere length (bps)") +
                                scale_x_discrete(limits = c("C. elegans VC2010/PD1074 re-sequencing (Yoshimura 2019)",
                                                            "C. elegans CB4856 re-sequencing (Kim 2019)",
                                                            "C. briggsae QX1410 sequencing (Stevens 2022)",
                                                            "D. coronatus PacBio HiFi genomic library (this work)",
                                                            "D. pachys ONT R9.4 genomic library (this work)"),
                                                 labels = c("C. elegans VC2010",
                                                            "C. elegans CB4856",
                                                            "C. briggsae QX1410",
                                                            "D. coronatus PDL0010",
                                                            "D. pachys PF1309")) +
                                scale_y_continuous(limits = c(0,8000)) +
                                theme(legend.key.size = unit(0.2, 'cm')) +
                                coord_flip() +
                                theme(axis.text.x = element_text(size = axis_text_size), axis.text.y = element_text(size = axis_text_size)) +
                                theme(axis.title.x = element_text(size = axis_text_size), axis.title.y = element_text(size = axis_text_size)) +
                                theme(legend.text=element_text(size=axis_text_size), legend.title=element_text(size=axis_text_size))
                                

telomere_dotplot_horizontal

```


```{r}
ggsave("telomere_lengths_dot_box_plots_horizontal_2025-12.pdf", telomere_dotplot_horizontal, width = 9, height = 4, units = "cm")
```
